{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate,useParams}from'react-router-dom';import{createOrderItem,updateOrderItem,getOrderItemById,getRequestData,getPendingRequests}from'../../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AddOrderItem=()=>{const[form,setForm]=useState({request_id:'',product_id:'',quantity:'',supplier_id:'',date:''});const[requests,setRequests]=useState([]);const[products,setProducts]=useState([]);const[suppliers,setSuppliers]=useState([]);const navigate=useNavigate();const{id}=useParams();const isEditing=Boolean(id);useEffect(()=>{fetchRequests();if(isEditing){fetchOrderItem();}},[id]);const fetchRequests=async()=>{try{const response=await getPendingRequests();setRequests(response.data.requests);}catch(error){console.error('Failed to fetch pending requests',error);}};const fetchOrderItem=async()=>{try{const response=await getOrderItemById(id);setForm(response.data);}catch(error){console.error('Failed to fetch order item',error);}};const handleChange=e=>{const{name,value}=e.target;setForm({...form,[name]:value});if(name==='request_id'){fetchRequestData(value);}};const fetchRequestData=async requestId=>{try{const response=await getRequestData(requestId);const{request,products,suppliers}=response.data;setProducts(products);setSuppliers(suppliers);setForm(form=>({...form,request_id:requestId,product_id:request.product_id,quantity:request.quantity}));}catch(error){console.error('Failed to fetch request data',error);}};const handleSubmit=async e=>{e.preventDefault();try{if(isEditing){await updateOrderItem(id,form);}else{await createOrderItem(form);}navigate('/order_items');}catch(error){console.error('Failed to save order item',error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h3\",{children:isEditing?'Edit Order Item':'Add New Order Item'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Request:\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"request_id\",value:form.request_id,onChange:handleChange,className:\"form-control\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Request\"}),requests.map(request=>/*#__PURE__*/_jsx(\"option\",{value:request.id,children:\"\".concat(request.product_name,\" - \").concat(request.quantity,\" - \").concat(request.outlet_name)},request.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Product:\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"product_id\",value:form.product_id,onChange:handleChange,className:\"form-control\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Product\"}),products.map(product=>/*#__PURE__*/_jsx(\"option\",{value:product.id,children:product.name},product.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Quantity:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"quantity\",value:form.quantity,onChange:handleChange,className:\"form-control\",required:true,min:\"0\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Supplier:\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"supplier_id\",value:form.supplier_id,onChange:handleChange,className:\"form-control\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Supplier\"}),suppliers.map(supplier=>/*#__PURE__*/_jsx(\"option\",{value:supplier.id,children:supplier.name},supplier.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Date:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"date\",value:form.date,onChange:handleChange,className:\"form-control\",required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-dark\",children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-dark\",style:{marginLeft:'10px'},onClick:()=>navigate('/order_items'),children:\"Cancel\"})]})]});};export default AddOrderItem;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useParams","createOrderItem","updateOrderItem","getOrderItemById","getRequestData","getPendingRequests","jsx","_jsx","jsxs","_jsxs","AddOrderItem","form","setForm","request_id","product_id","quantity","supplier_id","date","requests","setRequests","products","setProducts","suppliers","setSuppliers","navigate","id","isEditing","Boolean","fetchRequests","fetchOrderItem","response","data","error","console","handleChange","e","name","value","target","fetchRequestData","requestId","request","handleSubmit","preventDefault","className","children","onSubmit","onChange","required","map","concat","product_name","outlet_name","product","type","min","supplier","style","marginLeft","onClick"],"sources":["D:/InformationSystemTradingOrganization/frontend/src/components/OrderItems/AddOrderItem.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { createOrderItem, updateOrderItem, getOrderItemById, getRequestData, getPendingRequests } from '../../services/api';\r\n\r\nconst AddOrderItem = () => {\r\n    const [form, setForm] = useState({\r\n        request_id: '',\r\n        product_id: '',\r\n        quantity: '',\r\n        supplier_id: '',\r\n        date: ''\r\n    });\r\n\r\n    const [requests, setRequests] = useState([]);\r\n    const [products, setProducts] = useState([]);\r\n    const [suppliers, setSuppliers] = useState([]);\r\n\r\n    const navigate = useNavigate();\r\n    const { id } = useParams();\r\n    const isEditing = Boolean(id);\r\n\r\n    useEffect(() => {\r\n        fetchRequests();\r\n        if (isEditing) {\r\n            fetchOrderItem();\r\n        }\r\n    }, [id]);\r\n\r\n    const fetchRequests = async () => {\r\n        try {\r\n            const response = await getPendingRequests();\r\n            setRequests(response.data.requests);\r\n        } catch (error) {\r\n            console.error('Failed to fetch pending requests', error);\r\n        }\r\n    };\r\n\r\n    const fetchOrderItem = async () => {\r\n        try {\r\n            const response = await getOrderItemById(id);\r\n            setForm(response.data);\r\n        } catch (error) {\r\n            console.error('Failed to fetch order item', error);\r\n        }\r\n    };\r\n\r\n    const handleChange = (e) => {\r\n        const { name, value } = e.target;\r\n        setForm({ ...form, [name]: value });\r\n\r\n        if (name === 'request_id') {\r\n            fetchRequestData(value);\r\n        }\r\n    };\r\n\r\n    const fetchRequestData = async (requestId) => {\r\n        try {\r\n            const response = await getRequestData(requestId);\r\n            const { request, products, suppliers } = response.data;\r\n            setProducts(products);\r\n            setSuppliers(suppliers);\r\n            setForm(form => ({\r\n                ...form,\r\n                request_id: requestId,\r\n                product_id: request.product_id,\r\n                quantity: request.quantity\r\n            }));\r\n        } catch (error) {\r\n            console.error('Failed to fetch request data', error);\r\n        }\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        try {\r\n            if (isEditing) {\r\n                await updateOrderItem(id, form);\r\n            } else {\r\n                await createOrderItem(form);\r\n            }\r\n            navigate('/order_items');\r\n        } catch (error) {\r\n            console.error('Failed to save order item', error);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"container\">\r\n            <h3>{isEditing ? 'Edit Order Item' : 'Add New Order Item'}</h3>\r\n            <form onSubmit={handleSubmit}>\r\n                <div className=\"form-group\">\r\n                    <label>Request:</label>\r\n                    <select\r\n                        name=\"request_id\"\r\n                        value={form.request_id}\r\n                        onChange={handleChange}\r\n                        className=\"form-control\"\r\n                        required\r\n                    >\r\n                        <option value=\"\">Select Request</option>\r\n                        {requests.map(request => (\r\n                            <option key={request.id} value={request.id}>\r\n                                {`${request.product_name} - ${request.quantity} - ${request.outlet_name}`}\r\n                            </option>\r\n                        ))}\r\n                    </select>\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <label>Product:</label>\r\n                    <select\r\n                        name=\"product_id\"\r\n                        value={form.product_id}\r\n                        onChange={handleChange}\r\n                        className=\"form-control\"\r\n                        required\r\n                    >\r\n                        <option value=\"\">Select Product</option>\r\n                        {products.map(product => (\r\n                            <option key={product.id} value={product.id}>\r\n                                {product.name}\r\n                            </option>\r\n                        ))}\r\n                    </select>\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <label>Quantity:</label>\r\n                    <input\r\n                        type=\"number\"\r\n                        name=\"quantity\"\r\n                        value={form.quantity}\r\n                        onChange={handleChange}\r\n                        className=\"form-control\"\r\n                        required\r\n                        min=\"0\"\r\n                    />\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <label>Supplier:</label>\r\n                    <select\r\n                        name=\"supplier_id\"\r\n                        value={form.supplier_id}\r\n                        onChange={handleChange}\r\n                        className=\"form-control\"\r\n                        required\r\n                    >\r\n                        <option value=\"\">Select Supplier</option>\r\n                        {suppliers.map(supplier => (\r\n                            <option key={supplier.id} value={supplier.id}>\r\n                                {supplier.name}\r\n                            </option>\r\n                        ))}\r\n                    </select>\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <label>Date:</label>\r\n                    <input\r\n                        type=\"date\"\r\n                        name=\"date\"\r\n                        value={form.date}\r\n                        onChange={handleChange}\r\n                        className=\"form-control\"\r\n                        required\r\n                    />\r\n                </div>\r\n                <button type=\"submit\" className=\"btn btn-dark\">Save</button>\r\n                <button type=\"button\" className=\"btn btn-dark\" style={{ marginLeft: '10px' }} onClick={() => navigate('/order_items')}>Cancel</button>\r\n            </form>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AddOrderItem;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}